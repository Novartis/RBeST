[{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Probability of Success with Co-Data","text":"co-data concept introduced [1]. differs use historical data approach makes use contemporary data. meta-analytic-predictive (MAP) analysis assumes historical data known time-point specyfing analysis retrospective summary available data. MAP prior combined current trial data. co-data approach extends sequential procedure meta-analytic-combined (MAC) analysis. MAC approach available data analyzed single step - , historical concurrent data combined single inference step. approaches MAP MAC yield exactly results demonstrated appendix bottom. example co-data scenario drug development simultaneous execution twin phase III trails registriation. setting, futility analysis interim analysis may take historical contemporary data account co-data approach. example discussed [1] using probability success (PoS) metric assess futility interim analysis discussed detail. key property probability success metric consideration uncertainty parameters conditional available data. contrast, conditional power (CP) calculates frequency given experemintal design successful known value parameters. example, 1-sample experiment one-sided success criterion trial successful collected data \\(y_N\\) sample size \\(N\\) exceeds critical value \\(y_c\\); recall critical value \\(y_c\\) determined success criterion, prior sample size evaluated. Assuming sampling model data \\(p(y|\\theta)\\), \\[ CP_N(\\theta) = \\int (y_N  > y_c) \\, p(y_N|\\theta) \\, dy_N.\\] integration data \\(y_N\\) comprises possible outcomes trial. Note start trial, \\(CP_N(\\theta_0)\\) type error rate conventional null hypothesis (\\(\\theta=\\theta_0\\)) \\(CP_N(\\theta_a)\\) power trial alternative (\\(\\theta=\\theta_a\\)). interim analysis sample size \\(n_I\\), conditional power evaluated conditional observed data far (\\(n_I\\) measurements) remaining sample size (\\(N-n_I\\)) random distributed according \\(p(y|\\theta)\\) \\(\\theta\\) set known value, \\[ CP_{N-n_I}(\\theta|y_{n_I}) = \\int (y_{n_I} + y_{N-n_I} = y_N > y_c|y_{n_I}) \\, p(y_{N-n_I}|\\theta) \\, dy_{N-n_I}.\\] known value can set equal observed point estimate interim, \\(CP_{N-n_I}(\\hat{\\theta}_{}|y_{n_I})\\), assumed true alternative, \\(CP_{N-n_I}(\\theta_a|y_{n_I})\\), used plan trial. probability success contrast assigns \\(\\theta\\) distribution marginalizes conditional power distribution. absence additional trial external information distribution posterior \\(p(\\theta|y_{n_I})\\) obtained prior \\(p(\\theta)\\) data collected interim, \\[ PoS_I = \\int CP_{N-n_I}(\\theta|y_{n_I}) \\, p(\\theta|y_{n_I}) \\, d\\theta.\\] However, knowledge \\(\\theta\\) can refined data-sources like completed (historical) concurrent trials available, \\[ PoS_{,H,...} = \\int CP_{N-n_I}(\\theta|y_{n_I}) \\, p(\\theta|y_{},y_{H},...) \\, d\\theta.\\] important note conditional power always evaluated respect trial data (prior) . Thus, additional data-sources part analysis trial. practice means probability success usually calculated trial uses non-informative priors, interim may use additional data-sources refine knowledge \\(\\theta\\) part trial analysis.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"example-data-scenario","dir":"Articles","previous_headings":"","what":"Example Data Scenario","title":"Probability of Success with Co-Data","text":"following hypothetical example [1] discussed. assumed endpoint time--event, analyzed using normal approximation log-rank statistic comparing two groups. 1:1 randomization sampling distribution log-hazard ratio normal distribution sampling standard deviation \\(2\\) standard error \\(\\sqrt{4/N_{events}}\\) sample size \\(N_{events}\\). historical data considered proof concept phase II trial. twin phase III studies event driven. trial stops whenever total \\(379\\) events reached interim planned whenever least \\(150\\) events occured. assumed true hazard ratio used design trial \\(0.8\\). Example data: remaining outline vignette first evaluate design properties trials, calculate probability success interim trial (using trial data). Next, probability success calculated using addition historical data. Subsequently, probability success trial calculated also using historical data concurrent phase III data trial B. Finally, overall probability success calculated, defined joint success trials. appendix equivalence MAP MAC approach demonstrated.","code":"trials <- data.frame(study  = c(\"PoC\", \"PhII\", \"PhIII_A\", \"PhIII_B\"),                      deaths = c(    8,     85,       162,       150),                      HR     = c(  0.7,   0.75,      0.83,      0.78),                      stringsAsFactors = FALSE                      ) ## under the normal approximation of the log-HR, the sampling sd is 2 ## such that the standard errors are sqrt(4/events) trials <- trials %>%     mutate(logHR=log(HR), sem=sqrt(4/deaths)) kable(trials, digits=2)"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"statistical-trial-design-considerations","dir":"Articles","previous_headings":"","what":"Statistical Trial Design Considerations","title":"Probability of Success with Co-Data","text":"Key design choices: time--event endpoint phase III trials stop target # events 379 null hypothesis difference HR, \\(\\theta_0 = 1.0\\) one-sided \\(\\alpha = 0.025\\) alternative hypothesis assumes true HR \\(\\theta_a=0.75\\) interim least 150 events reached Historical data: promising internal PoC promising phase II Co-data: two phase III trials run parallel \\(\\Rightarrow\\) phase III trial concurrent Define design choices","code":"Nev <- 379  alt_HR <- 0.75 alt_logHR <- log(alt_HR)  alpha <- 0.025"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"power-calculation","dir":"Articles","previous_headings":"Statistical Trial Design Considerations","what":"Power calculation","title":"Probability of Success with Co-Data","text":"use unit information prior non-informative prior define using mean & effective sample size (ESS) specification: Define conditional power overall trial: alternative design choices result 80% power impact unit-information prior minimal can seen comparing frequentist calculation: RBesT can explore conditional power range alternatives:","code":"unit_inf <- mixnorm(c(1, 0, 1), sigma=2, param=\"mn\") unit_inf ## Univariate normal mixture ## Reference scale: 2 ## Mixture Components: ##   comp1 ## w 1     ## m 0     ## s 2 success_crit <- decision1S(1-alpha, 0) ## let's print the defined criterion success_crit ## 1 sample decision function ## Conditions for acceptance: ## P(theta <= 0) > 0.975 design <- oc1S(unit_inf, Nev, success_crit, sigma=2) design(alt_logHR) ## [1] 0.7986379 power.t.test(n=Nev, delta=-1*alt_logHR, sd=2, type=\"one.sample\", sig.level=0.025, alternative=\"one.sided\") ##  ##      One-sample t test power calculation  ##  ##               n = 379 ##           delta = 0.2876821 ##              sd = 2 ##       sig.level = 0.025 ##           power = 0.7976343 ##     alternative = one.sided ggplot(data.frame(HR=c(0.5, 1.2)), aes(HR)) +     stat_function(fun=compose(design, log)) +     vline_at(c(alt_HR, 1.0), linetype=I(2)) +     scale_y_continuous(breaks=seq(0,1,by=0.1)) +     scale_x_continuous(breaks=c(alt_HR, seq(0,1.2,by=0.2))) +     ylab(NULL) + xlab(expression(theta[a])) +     ggtitle(paste(\"Power for N =\", Nev, \"events\"))"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"critical-value","dir":"Articles","previous_headings":"Statistical Trial Design Considerations","what":"Critical value","title":"Probability of Success with Co-Data","text":"critical value determines observed logHR just conclude success criterion fulfilled. can check : Ok, observing critical value, get success. Now, observe 1% worse result? success \\(\\Rightarrow\\) critical boundary value.","code":"design_crit <- decision1S_boundary(unit_inf, Nev, success_crit, sigma=2)  design_crit ## [1] -0.2017185 exp(design_crit) ## [1] 0.8173249 success_crit(postmix(unit_inf, m=design_crit, n=379)) ## Using default prior reference scale 2 ## [1] 1 success_crit(postmix(unit_inf, m=design_crit+log(1.01), n=379)) ## Using default prior reference scale 2 ## [1] 0"},{"path":[]},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"no-use-of-historical-information","dir":"Articles","previous_headings":"PoS at interim for phase III trial A only","what":"No use of historical information","title":"Probability of Success with Co-Data","text":"Posterior treatment effect interim. trial uses non-informative prior treatment effect: Now interested PoS trial completion. prior use analysis second half given data collected far. returned function can now calculate PoS assuming distribution treatment effect. case use historical information, just interim posterior: command integrates conditional power uncertainty treatment effect defined \\(PoS_I\\). conditional power operating characteristics trial coincide whenever condition observed data. key difference conditional power compared probability success assumes known value parameter interest. can seen follows: First define conditional power conditional observed data, \\(CP_{N-n_I}(\\theta|y_{n_I})\\): conditional power assuming alternative true (HR 0.75): case uncertainty treatment effect (\\(se=10^-4\\)), result agrees probability success calculation: trial B calculation :","code":"interim_A <- postmix(unit_inf, m=trials$logHR[3], se=trials$sem[3]) interim_A ## Univariate normal mixture ## Reference scale: 2 ## Mixture Components: ##   comp1      ## w  1.0000000 ## m -0.1851865 ## s  0.1566521 interim_pos_A <- pos1S(interim_A, Nev-trials$deaths[3], success_crit, sigma=2) interim_pos_A(interim_A) ## [1] 0.4465623 interim_oc_A <- oc1S(interim_A, Nev-trials$deaths[3], success_crit, sigma=2) interim_oc_A(alt_logHR) ## [1] 0.708769 interim_pos_A(mixnorm(c(1, alt_logHR, 1E-4))) ## [1] 0.7087689 interim_B <- postmix(unit_inf, m=trials$logHR[4], se=trials$sem[4]) interim_pos_B <- pos1S(interim_B, Nev-trials$deaths[4], success_crit, sigma=2) interim_pos_B(interim_B) ## [1] 0.6411569"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"use-of-historical-information---map-approach","dir":"Articles","previous_headings":"PoS at interim for phase III trial A only","what":"Use of historical information - MAP approach","title":"Probability of Success with Co-Data","text":"However, historical information can take advantage interim better informed decision. data phase III trials includes PoC phase II trial. now derive MAP prior; recall MAP prior prediction log-hazard ratio future trial:   interim even knowledge available treatment effect interim data can include MAP prior: PoS posterior interim (representing historical interim data collected) : Note redefined interim_pos_A, calculates PoS phase III trial taking account final analysis use non-informative prior. trial B calculation :","code":"base <- trials[1:2,]  set.seed(342345) base_map_mc <- gMAP(cbind(logHR, sem) ~ 1 | study,                     family=gaussian,                     data=base,                     weights=deaths,                     tau.dist=\"HalfNormal\", tau.prior=0.5,                     beta.prior=cbind(0, 2))  forest_plot(base_map_mc, est=\"MAP\") base_map <- automixfit(base_map_mc)  plot(base_map)$mix + xlab(expression(log(theta))) base_map ## EM for Normal Mixture Model ## Log-Likelihood = -3104.792 ##  ## Univariate normal mixture ## Reference scale: 2 ## Mixture Components: ##   comp1      comp2      ## w  0.7168182  0.2831818 ## m -0.2924092 -0.2854492 ## s  0.3207656  0.9853281 interim_A_combined <- postmix(base_map, m=trials$logHR[3], se=trials$sem[3]) interim_pos_A(interim_A_combined) ## [1] 0.4830275 interim_B_combined <- postmix(base_map, m=trials$logHR[4], se=trials$sem[4]) interim_pos_B(interim_B_combined) ## [1] 0.6671022"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"use-of-historical-information---mac-approach","dir":"Articles","previous_headings":"PoS at interim for phase III trial A only","what":"Use of historical information - MAC approach","title":"Probability of Success with Co-Data","text":"However, even information can used , since phase III result trial B also available: Now trial B specific posterior interim can extract : obtain posterior (restrict first 4 columns) turn MCMC posterior sample parametric mixture finally evaluate PoS aligns published result assumption full exchangeability. trial B computations :","code":"interim_map_mc <- update(base_map_mc, data=trials) kable(fitted(interim_map_mc), digits=3) interim_map_post <- as.matrix(interim_map_mc)[,1:4]  dim(interim_map_post) # posterior is given as matrix: iteration x parameter ## [1] 4000    4 head(interim_map_post, n=3) ##           parameters ## iterations   theta[1]   theta[2]   theta[3]    theta[4] ##       [1,] -0.3623903 -0.2900111 -0.3895817 -0.33736354 ##       [2,] -0.2242586 -0.1874217 -0.3220046 -0.26273504 ##       [3,] -0.2010753 -0.1312968 -0.2283423 -0.05753074 interim_A_allcombined <- automixfit(interim_map_post[,\"theta[3]\"]) interim_pos_A(interim_A_allcombined) ## [1] 0.5045411 interim_B_allcombined <- automixfit(interim_map_post[,\"theta[4]\"]) interim_pos_B(interim_B_allcombined) ## [1] 0.6411948"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"differential-discounting","dir":"Articles","previous_headings":"","what":"Differential discounting","title":"Probability of Success with Co-Data","text":"Differential discounting allows weight different data-sources differently. example, may assume greater heterogeneity historical data comparison twin phase III trials. Assign data historical (2) concurrent data strata (1):","code":"trials <- trials %>% mutate(stratum=c(2, 2, 1, 1))  kable(trials, digits=2) set.seed(435345) interim_diff_map_mc <- gMAP(cbind(logHR, sem) ~ 1 | study,                             tau.strata=stratum,                             family=gaussian,                             data=trials,                             weights=deaths,                             tau.dist=\"HalfNormal\", tau.prior=c(0.5, 1),                             beta.prior=cbind(0, 2))  interim_diff_map_post <- as.matrix(interim_diff_map_mc)[,1:4]  interim_A_diff_allcombined <- automixfit(interim_diff_map_post[,\"theta[3]\"]) interim_B_diff_allcombined <- automixfit(interim_diff_map_post[,\"theta[4]\"])  interim_pos_A(interim_A_diff_allcombined) ## [1] 0.4873289 interim_pos_B(interim_B_diff_allcombined) ## [1] 0.6383215"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"pos-for-both-phase-iii-trials-being-successful","dir":"Articles","previous_headings":"","what":"PoS for both phase III trials being successful","title":"Probability of Success with Co-Data","text":"far calculated individual PoS per trial, interesting overall PoS trials successful. Recall, PoS conditional power integrated assumed true effect distribution. Hence, trial : explained, conditional power operating characerstic design conditioning already observed data: PoS integral conditional power parameter space \\(\\theta\\) representing knowledge. integral can evaluated Monte-Carlo (MC) approach \\[ PoS_I = \\int CP_{N-n_I}(\\theta|y_{n_I}) \\, p(\\theta|y_{n_I}) \\, d\\theta \\approx \\frac{1}{S} \\sum_{=1}^S CP(\\theta_i),\\] whenever sample \\(p(\\theta|y_{n_I})\\) size \\(S\\)… : MC approach calculating PoS. now considering probability trials successful perform MC integration joint density \\(p(\\theta_A,\\theta_B|y_{n_{I_A}},y_{n_{I_B}})\\) \\[ \\begin{aligned} PoS &= \\iint CP_{N-n_{I_A}}(\\theta_A|y_{n_{I_A}}) \\, CP_{N-n_{I_B}}(\\theta_B|y_{n_{I_B}})\\, p(\\theta_A,\\theta_B|y_{n_{I_A}},y_{n_{I_B}}) \\, d\\theta_A d\\theta_B \\\\ & \\approx \\frac{1}{S} \\sum_{=1}^S CP_{N-n_{I_A}}(\\theta_{,}|y_{n_{I_A}}) \\, CP_{N-n_{I_B}}(\\theta_{B,}|y_{n_{I_B}}). \\end{aligned} \\] Thus need also get conditional power trial B interim… …integrate posterior samples (differential discounting case) slightly larger assuming independence: due dependence posteriors full exchangeability case ","code":"interim_pos_A(interim_A) ## [1] 0.4465623 interim_oc_A <- oc1S(interim_A, Nev-trials$deaths[3], success_crit, sigma=2) interim_A_samp <- rmix(interim_A, 1E4) mean(interim_oc_A(interim_A_samp)) ## [1] 0.4481538 interim_oc_B <- oc1S(interim_B, Nev-trials$deaths[4], success_crit, sigma=2) mean(interim_oc_A(interim_diff_map_post[,\"theta[3]\"]) * interim_oc_B(interim_diff_map_post[,\"theta[4]\"])) ## [1] 0.33994 interim_pos_A(interim_A) * interim_pos_B(interim_B) ## [1] 0.2863165 cor(interim_diff_map_post[,c(\"theta[3]\", \"theta[4]\")]) ##           theta[3]  theta[4] ## theta[3] 1.0000000 0.3070583 ## theta[4] 0.3070583 1.0000000 mean(interim_oc_A(interim_map_post[,\"theta[3]\"]) * interim_oc_B(interim_map_post[,\"theta[4]\"])) ## [1] 0.3547286"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Probability of Success with Co-Data","text":"now calculated increasing complexity probability success various data constellations. new trials conducted whenever previous trial results positive, important take note potential selection bias. Moreover, adding historical data sources situation likely increase probability success illustrated summary preceding calculations. Phase III trial : Phase III trial B:","code":"## only interim data of trial A  interim_pos_A(interim_A) ## [1] 0.4465623 ## in addition with prior historical data PoC & phase II data interim_pos_A(interim_A_combined) ## [1] 0.4830275 ## finally with the interim data of the phase III B interim_pos_A(interim_A_allcombined) ## [1] 0.5045411 ## only interim data of trial B interim_pos_B(interim_B) ## [1] 0.6411569 ## in addition with prior historical data PoC & phase II data interim_pos_B(interim_B_combined) ## [1] 0.6671022 ## finally with the interim data of the phase III A interim_pos_B(interim_B_allcombined) ## [1] 0.6411948"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"appendix-map-and-mac-equivalence","dir":"Articles","previous_headings":"","what":"Appendix: MAP and MAC equivalence","title":"Probability of Success with Co-Data","text":"preceeding sections used MAP MAC equivalence already. proof equivalence presented reference [2]. formal deriavtion shown end section MAP MAC provide exact results, difference sequential vs joint analysis (see also [2]): MAP: Summarize historical information MAP update MAP trial result (MCMC, postmix). MAC: Directly summarize historical information trial result single step (MCMC data). two results using MAP MAC line . reason MAP approach used historical data phase III trial interim data . contrast, MAC approach used historical data interim phase III data trials. show equivalence need align mismatch used data. Run gMAP base data produce large MCMC sample (10 chains) get high precision. Force accurate fit 5 components: Now, combine MAP prior (representing historical knowledge) interim data trial : Run respective MAC analysis (thus need historical data + phase III trial, excluding phase III B data): turn MCMC posterior sample parametric mixture Now let’s overlay two posterior’s  PoS essentially ","code":"base_map_mc_2 <- gMAP(cbind(logHR, sem) ~ 1 | study,                       family=gaussian,                       data=base,                       weights=deaths,                       tau.dist=\"HalfNormal\", tau.prior=0.5,                       beta.prior=cbind(0, 2),                       chains=ifelse(is_CRAN, 2, 20)) ## Warning: There were 1 divergent transitions after warmup. See ## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. ## Warning: Examine the pairs() plot to diagnose sampling problems ## Warning in gMAP(cbind(logHR, sem) ~ 1 | study, family = gaussian, data = base, : In total 1 divergent transitions occured during the sampling phase. ## Please consider increasing adapt_delta closer to 1 with the following command prior to gMAP: ## options(RBesT.MC.control=list(adapt_delta=0.999)) base_map_2 <- mixfit(base_map_mc_2, Nc=5) base_map_2 ## EM for Normal Mixture Model ## Log-Likelihood = -15047.22 ##  ## Univariate normal mixture ## Reference scale: 2 ## Mixture Components: ##   comp1       comp2       comp3       comp4       comp5       ## w  0.43208424  0.21551725  0.16755331  0.11092824  0.07391696 ## m -0.24268064 -0.53982085  0.17011775 -0.16621721 -0.97544937 ## s  0.23995076  0.28288691  0.39081125  1.17332484  0.45821504 interim_A_combined_2 <- postmix(base_map_2, m=trials$logHR[3], se=trials$sem[3]) interim_map_mc_2 <- update(base_map_mc_2, data=trials[-4,]) ## Warning: There were 4 divergent transitions after warmup. See ## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. ## Warning: Examine the pairs() plot to diagnose sampling problems ## Warning in gMAP(formula = cbind(logHR, sem) ~ 1 | study, family = gaussian, : In total 4 divergent transitions occured during the sampling phase. ## Please consider increasing adapt_delta closer to 1 with the following command prior to gMAP: ## options(RBesT.MC.control=list(adapt_delta=0.999)) interim_map_post_2 <- as.matrix(interim_map_mc_2)[,1:3] interim_A_allcombined_2 <- mixfit(interim_map_post_2[,\"theta[3]\"], Nc=5)  interim_A_allcombined_2 ## EM for Normal Mixture Model ## Log-Likelihood = 10876.23 ##  ## Univariate normal mixture ## Mixture Components: ##   comp1       comp2       comp3       comp4       comp5       ## w  0.23603614  0.23320524  0.21267294  0.19809855  0.11998713 ## m -0.11324196 -0.20613090 -0.10176815 -0.31365473 -0.39837515 ## s  0.13613082  0.05885107  0.08414952  0.06550526  0.09611289 ggplot(data.frame(logHR=c(-0.8,0.25)), aes(logHR)) +     stat_function(fun=dmix, args=list(mix=interim_A_combined_2), aes(linetype=\"MAP\")) +     stat_function(fun=dmix, args=list(mix=interim_A_allcombined_2), aes(linetype=\"MAC\")) +     scale_linetype_discrete(\"Analysis\") +     ggtitle(\"Posterior log hazard of phase III A trial at interim\") interim_pos_A(interim_A_combined_2) ## [1] 0.4866452 interim_pos_A(interim_A_allcombined_2) ## [1] 0.4874041"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"formal-map-and-mac-equivalence","dir":"Articles","previous_headings":"Appendix: MAP and MAC equivalence","what":"Formal MAP and MAC equivalence","title":"Probability of Success with Co-Data","text":"stated equivalence requires posterior trial specific parameter \\[p(\\theta_\\star|y_\\star,y_H),\\] conditional trial specific data \\(y_\\star\\) historical data \\(y_H\\) (MAC approach, joint use \\(y_H,y_\\star\\)), equivalent obtaining MAP prior \\(p(\\theta_\\star|y_H)\\) based historical data analyzing new trial prior. \\[ \\begin{aligned} p(\\theta_\\star|y_\\star,y_H) &\\propto p(\\theta_\\star,\\theta_H|y_\\star,y_H) \\\\ &\\propto p(y_\\star,y_H|\\theta_\\star,\\theta_H) \\, p(\\theta_\\star,\\theta_H) \\\\ &= p(y_\\star|\\theta_\\star) \\, p(y_H|\\theta_H) \\, p(\\theta_\\star,\\theta_H) \\\\ &\\propto p(y_\\star|\\theta_\\star) \\, p(\\theta_\\star,\\theta_H|y_H) \\\\ &\\propto p(y_\\star|\\theta_\\star) \\, p(\\theta_\\star|y_H) \\end{aligned} \\] equivalence holds use meta-analytic model.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Probability of Success with Co-Data","text":"[1] Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). Use Co-Data Clinical Trials. Statistics Biopharmaceutical Research, 8(3), 345-354. [2] 1. Schmidli H, Gsteiger S, Roychoudhury S, O’Hagan , Spiegelhalter D, Neuenschwander B. Robust meta-analytic-predictive priors clinical trials historical control information. Biometrics. 2014;70(4):1023-1032.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_codata.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R Session Info","title":"Probability of Success with Co-Data","text":"","code":"sessionInfo() ## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggplot2_3.4.0    purrr_1.0.1      dplyr_1.1.0      bayesplot_1.10.0 ## [5] knitr_1.42       RBesT_1.6-5      ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           plyr_1.8.8           ## [10] R6_2.5.1             backports_1.4.1      stats4_4.2.2         ## [13] evaluate_0.20        highr_0.10           pillar_1.8.1         ## [16] rlang_1.0.6          callr_3.7.3          jquerylib_0.1.4      ## [19] checkmate_2.1.0      rmarkdown_2.20       pkgdown_2.0.7        ## [22] labeling_0.4.2       textshaping_0.3.6    desc_1.4.2           ## [25] stringr_1.5.0        loo_2.5.1            munsell_0.5.0        ## [28] compiler_4.2.2       xfun_0.37            rstan_2.21.8         ## [31] pkgconfig_2.0.3      systemfonts_1.0.4    pkgbuild_1.4.0       ## [34] rstantools_2.2.0     htmltools_0.5.4      tidyselect_1.2.0     ## [37] tensorA_0.36.2       tibble_3.1.8         gridExtra_2.3        ## [40] codetools_0.2-18     matrixStats_0.63.0   fansi_1.0.4          ## [43] withr_2.5.0          crayon_1.5.2         distributional_0.3.1 ## [46] grid_4.2.2           jsonlite_1.8.4       gtable_0.3.1         ## [49] lifecycle_1.0.3      posterior_1.3.1      magrittr_2.0.3       ## [52] StanHeaders_2.21.0-7 scales_1.2.1         RcppParallel_5.1.6   ## [55] cli_3.6.0            stringi_1.7.12       cachem_1.0.6         ## [58] reshape2_1.4.4       farver_2.1.1         fs_1.6.1             ## [61] bslib_0.4.2          ragg_1.2.5           generics_0.1.3       ## [64] vctrs_0.5.2          Formula_1.2-4        tools_4.2.2          ## [67] glue_1.6.2           abind_1.4-5          processx_3.8.0       ## [70] parallel_4.2.2       fastmap_1.1.0        yaml_2.3.7           ## [73] inline_0.3.19        colorspace_2.1-0     memoise_2.0.1        ## [76] sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/articles/PoS_interim.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R Session Info","title":"Probability of Success at an Interim Analysis","text":"","code":"## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] RBesT_1.6-5   dplyr_1.1.0   knitr_1.42    scales_1.2.1  ggplot2_3.4.0 ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           R6_2.5.1             ## [10] backports_1.4.1      stats4_4.2.2         evaluate_0.20        ## [13] highr_0.10           pillar_1.8.1         rlang_1.0.6          ## [16] callr_3.7.3          jquerylib_0.1.4      checkmate_2.1.0      ## [19] rmarkdown_2.20       pkgdown_2.0.7        labeling_0.4.2       ## [22] textshaping_0.3.6    desc_1.4.2           stringr_1.5.0        ## [25] loo_2.5.1            munsell_0.5.0        compiler_4.2.2       ## [28] xfun_0.37            rstan_2.21.8         pkgconfig_2.0.3      ## [31] systemfonts_1.0.4    pkgbuild_1.4.0       rstantools_2.2.0     ## [34] htmltools_0.5.4      tidyselect_1.2.0     tibble_3.1.8         ## [37] gridExtra_2.3        codetools_0.2-18     matrixStats_0.63.0   ## [40] fansi_1.0.4          crayon_1.5.2         withr_2.5.0          ## [43] grid_4.2.2           jsonlite_1.8.4       gtable_0.3.1         ## [46] lifecycle_1.0.3      magrittr_2.0.3       StanHeaders_2.21.0-7 ## [49] RcppParallel_5.1.6   cli_3.6.0            stringi_1.7.12       ## [52] cachem_1.0.6         farver_2.1.1         fs_1.6.1             ## [55] bslib_0.4.2          ragg_1.2.5           generics_0.1.3       ## [58] vctrs_0.5.2          Formula_1.2-4        tools_4.2.2          ## [61] glue_1.6.2           purrr_1.0.1          parallel_4.2.2       ## [64] processx_3.8.0       fastmap_1.1.0        yaml_2.3.7           ## [67] inline_0.3.19        colorspace_2.1-0     memoise_2.0.1        ## [70] sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/articles/customizing_plots.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Customizing RBesT plots","text":"vignette demonstrates work forest plot provided RBesT package. show modify default plot , advanced users, extract data ggplot object create new plot scratch. Finally recreate plots case study presented training materials. general information plotting R, recommend following resources: bayesplot - library RBesT plotting functionality built ggplot2 - powerful library graphics R R Cookbook - Graphs - general reference R graphics R","code":"# Load required libraries library(RBesT) library(ggplot2) library(dplyr) library(tidyr) library(bayesplot)  # Default settings for bayesplot color_scheme_set(\"blue\") theme_set(theme_default(base_size=12))  # Load example gMAP object set.seed(546346) map_crohn <- gMAP(cbind(y, y.se) ~ 1 | study,                   family=gaussian,                   data=transform(crohn, y.se=88/sqrt(n)),                   weights=n,                   tau.dist=\"HalfNormal\", tau.prior=44,                   beta.prior=cbind(0,88))  print(map_crohn) ## Generalized Meta Analytic Predictive Prior Analysis ##  ## Call:  gMAP(formula = cbind(y, y.se) ~ 1 | study, family = gaussian,  ##     data = transform(crohn, y.se = 88/sqrt(n)), weights = n,  ##     tau.dist = \"HalfNormal\", tau.prior = 44, beta.prior = cbind(0,  ##         88)) ##  ## Exchangeability tau strata: 1  ## Prediction tau stratum    : 1  ## Maximal Rhat              : 1  ## Estimated reference scale : 88  ##  ## Between-trial heterogeneity of tau prediction stratum ##  mean    sd  2.5%   50% 97.5%  ## 14.50 10.10  1.09 12.20 41.10  ##  ## MAP Prior MCMC sample ##  mean    sd  2.5%   50% 97.5%  ## -49.8  19.3 -93.2 -48.3 -11.5"},{"path":"http://opensource.nibr.com/RBesT/articles/customizing_plots.html","id":"forest-plot","dir":"Articles","previous_headings":"","what":"Forest plot","title":"Customizing RBesT plots","text":"default forest plot “standard” forest plot Meta-Analytic-Predictive (MAP) prior additionally summarized bottom row:  can also include model-based estimates study, add legend explain different linetypes.  can modify color scheme follows (refer help(color_scheme_set) full list themes):    point size can modified vertical line removed:","code":"forest_plot(map_crohn) forest_plot(map_crohn, model=\"both\") + legend_move(\"right\") # preview a color scheme color_scheme_view(\"mix-blue-red\") # and now let's use it color_scheme_set(\"mix-blue-red\")  forest_plot(map_crohn) color_scheme_set(\"gray\") forest_plot(map_crohn) color_scheme_set(\"blue\") forest_plot(map_crohn, size=0.5, alpha=0)"},{"path":"http://opensource.nibr.com/RBesT/articles/customizing_plots.html","id":"presentation-ready-plots","dir":"Articles","previous_headings":"Forest plot","what":"Presentation-ready plots","title":"Customizing RBesT plots","text":"plot used presentation document study protocol, recommended use sufficiently large font sizes (e.g. large fonts slide document) elements plot clearly visible. show simple statements can used purpose.  also recommend saving plots explicitly ggsave function, allows control (hence consistency) image size. Note font size enforced requested size; small image large font size may result little space plot . image sized according golden cut (\\(\\phi=\\frac{1+\\sqrt5}{2} \\approx 1.62\\)) perceived pleasing axis ratio. Png recommended image file type presentations study documents.","code":"# adjust the base font size theme_set(theme_default(base_size=16)) forest_plot(map_crohn, model=\"both\", est=\"MAP\", size=1) + legend_move(\"right\") +   labs(title=\"Forest plot\", subtitle=\"Results of Meta-Analytic-Predictive (MAP) analysis\",         caption=\"Plot shows point estimates (posterior medians) with 95% intervals\") ggsave(\"plot1.png\", last_plot(), width=1.62*2.78, height=2.78, unit=\"in\") # too small for the chosen font size ggsave(\"plot2.png\", last_plot(), width=1.62*5.56, height=5.56, unit=\"in\") # fits a single ppt slide quite well"},{"path":[]},{"path":"http://opensource.nibr.com/RBesT/articles/customizing_plots.html","id":"extract-data-from-a-ggplot-object","dir":"Articles","previous_headings":"Advanced topics","what":"Extract data from a ggplot object","title":"Customizing RBesT plots","text":"situations, desired modifications plot provided RBesT may possible given returned ggplot object. truly tailored plot desired, user must extract data object create graph scratch using ggplot functions. Recall original forest plot:  Suppose wish use different symbols meta/stratified point estimates different linestyle vertical line. tailored plot can created follows.","code":"# Extract the data from the returned object fp_data <- forest_plot(map_crohn)$data print(fp_data, digits=2) ##                 mean  sem median  low    up    study      model ## Gastr06          -51 10.2    -51  -71 -30.9  Gastr06 stratified ## AIMed07          -49  6.8    -49  -62 -35.6  AIMed07 stratified ## NEJM07           -36  4.9    -36  -46 -26.5   NEJM07 stratified ## Gastr01a         -47 19.7    -47  -86  -8.4 Gastr01a stratified ## APhTh04          -90 17.6    -90 -124 -55.5  APhTh04 stratified ## Gastr01b         -54 11.6    -54  -77 -31.4 Gastr01b stratified ## theta_resp_pred  -50 19.3    -48  -93 -11.5      MAP       meta ## theta_resp       -50  8.4    -49  -69 -34.1     Mean       meta # Use a two-component map mixture to compute the vertical line location map_mix <- mixfit(map_crohn, Nc=2) # Finally compose a ggplot call for the desired graph ggplot(fp_data, aes(x=study, y=median, ymin=low, ymax=up, linetype=model, shape=model)) +    geom_pointrange(size=0.7, position=position_dodge(width=0.5)) +    geom_hline(yintercept=qmix(map_mix, 0.5), linetype=3, alpha=0.5) +   coord_flip() + theme_bw(base_size=12) + theme(legend.position=\"None\") +    labs(x=\"\", y=\"Response\", title=\"Modified forest plot\")"},{"path":"http://opensource.nibr.com/RBesT/articles/customizing_plots.html","id":"design-plots-a-clinical-trial","dir":"Articles","previous_headings":"Advanced topics","what":"Design plots a clinical trial","title":"Customizing RBesT plots","text":"show create outcome operating characteristic plots clinical trial comparing developmental drug placebo. primary endpoint binary (event probability \\(p\\)) use informative prior placebo arm event rate. experimental drug believed lower event rate, criteria study outcome hence follows: \\[ \\begin{align*} \\textrm{Criterion 1:}  \\Pr(p_{trt} / p_{pbo} < 1) &> 0.9\\\\ \\textrm{Criterion 2:}  \\Pr(p_{trt} / p_{pbo} < 0.5) &> 0.5 \\end{align*} \\] outcome success (GO) criteria satisfied, futility (STOP) neither satisfied, indeterminate one satisfied. now create plot shows study conclusion, given combination outcomes two treatment arms.  can also use design functions already derived (design_suc design_fut) compute operating characteristics.","code":"# Define prior distributions prior_pbo <- mixbeta(inf1=c(0.60, 19, 29), inf2=c(0.30, 4, 5), rob=c(0.10, 1, 1)) prior_trt <- mixbeta(c(1, 1/3, 1/3))  # Study sample size n_trt <- 50 n_pbo <- 20  # Create decision rules and designs to represent success and futility success <- decision2S(pc=c(0.90, 0.50), qc=c(log(1), log(0.50)), lower.tail=TRUE, link=\"log\") futility <- decision2S(pc=c(0.10, 0.50), qc=c(log(1), log(0.50)), lower.tail=FALSE, link=\"log\") design_suc <- oc2S(prior_trt, prior_pbo, n_trt, n_pbo, success) design_fut <- oc2S(prior_trt, prior_pbo, n_trt, n_pbo, futility) crit_suc <- decision2S_boundary(prior_trt, prior_pbo, n_trt, n_pbo, success) crit_fut <- decision2S_boundary(prior_trt, prior_pbo, n_trt, n_pbo, futility)  # Create a data frame that holds the outcomes for y1 (treatment) that define success and futility,  # conditional on the number of events on y2 (placebo) outcomes <- data.frame(y2=c(0:n_pbo), suc=crit_suc(0:n_pbo), fut=crit_fut(0:n_pbo), max=n_trt) outcomes$suc <- with(outcomes, ifelse(suc<0, 0, suc)) # don't allow negative number of events  # Finally put it all together in a plot.  o <- 0.5 # offset ggplot(outcomes, aes(x=y2, ymin=-o, ymax=suc+o)) + geom_linerange(size=4, colour=\"green\", alpha=0.6) +    geom_linerange(aes(ymin=suc+o, ymax=fut+o), colour=\"orange\", size=4, alpha=0.6) +    geom_linerange(aes(ymin=fut+o, ymax=max+o), colour=\"red\", size=4, alpha=0.6) +    annotate(\"text\", x=c(2,14), y=c(36,8), label=c(\"STOP\", \"GO\"), size=10) +    scale_x_continuous(breaks=seq(0,n_pbo,by=2)) +    scale_y_continuous(breaks=seq(0,n_trt,by=4)) +    labs(x=\"Events on placebo\", y=\"Events on treatment\", title=\"Study outcomes\") +    coord_flip() + theme_bw(base_size=12) # Define the grid of true event rates for which to evaluate OC p_trt <- seq(0, 0.5, length=200) p_pbo <- c(0.35, 0.40, 0.45, 0.50)  # Loop through the values for placebo and compute outcome probabilities  oc_list <- lapply(p_pbo, function(x) {   p_go <- design_suc(p_trt, x)   p_stop <- design_fut(p_trt, x)   data.frame(p_trt, p_pbo=x, Go=p_go, Stop=p_stop, Indeterminate=1-p_go-p_stop) }) # The above returns a list, so we bind the elements together into one data frame oc <- bind_rows(oc_list)  # And convert from wide to long format oc <- gather(oc, \"Outcome\", \"Probability\", 3:5) oc$facet_text <- as.factor(paste(\"True placebo rate = \", oc$p_pbo, sep=\"\"))  # Finally we are ready to plot ggplot(oc, aes(x=p_trt, y=Probability, colour=Outcome, linetype=Outcome)) +    facet_wrap(~facet_text) + geom_line(size=1) +    scale_colour_manual(values=c(\"green\", \"orange\", \"red\"), name=\"Outcome\") +    scale_linetype(guide=FALSE) +    geom_hline(yintercept=c(0.1, 0.8), linetype=3) +    scale_y_continuous(breaks=seq(0, 1, by=0.2)) +    labs(x=\"True event rate for treatment\", y=\"Probability\", title=\"Operating Characteristics\") +    theme_bw(base_size=12) sessionInfo() ## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] bayesplot_1.10.0 tidyr_1.3.0      dplyr_1.1.0      ggplot2_3.4.0    ## [5] RBesT_1.6-5      knitr_1.42       ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           R6_2.5.1             ## [10] backports_1.4.1      stats4_4.2.2         evaluate_0.20        ## [13] highr_0.10           pillar_1.8.1         rlang_1.0.6          ## [16] callr_3.7.3          jquerylib_0.1.4      checkmate_2.1.0      ## [19] rmarkdown_2.20       pkgdown_2.0.7        labeling_0.4.2       ## [22] textshaping_0.3.6    desc_1.4.2           stringr_1.5.0        ## [25] loo_2.5.1            munsell_0.5.0        compiler_4.2.2       ## [28] xfun_0.37            rstan_2.21.8         pkgconfig_2.0.3      ## [31] systemfonts_1.0.4    pkgbuild_1.4.0       rstantools_2.2.0     ## [34] htmltools_0.5.4      tidyselect_1.2.0     tibble_3.1.8         ## [37] gridExtra_2.3        codetools_0.2-18     matrixStats_0.63.0   ## [40] fansi_1.0.4          withr_2.5.0          crayon_1.5.2         ## [43] grid_4.2.2           jsonlite_1.8.4       gtable_0.3.1         ## [46] lifecycle_1.0.3      magrittr_2.0.3       StanHeaders_2.21.0-7 ## [49] scales_1.2.1         RcppParallel_5.1.6   cli_3.6.0            ## [52] stringi_1.7.12       cachem_1.0.6         farver_2.1.1         ## [55] fs_1.6.1             bslib_0.4.2          ragg_1.2.5           ## [58] generics_0.1.3       vctrs_0.5.2          Formula_1.2-4        ## [61] tools_4.2.2          glue_1.6.2           purrr_1.0.1          ## [64] processx_3.8.0       parallel_4.2.2       fastmap_1.1.0        ## [67] yaml_2.3.7           inline_0.3.19        colorspace_2.1-0     ## [70] memoise_2.0.1        sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting started with RBesT (binary)","text":"R Bayesian evidence synthesis Tools (RBesT) created facilitate use historical information clinical trials. relevant historical information identified, RBesT supports derivation informative priors via Meta-Analytic-Predictive (MAP) approach [1] evaluation trial’s operating characteristics. MAP approach performs standard meta-analysis followed prediction control group parameter future study accounting uncertainty population mean (standard result meta-analysis) -trial heterogeneity. Therefore, RBesT can also used meta-analysis tool one simply neglects prediction part. Let’s consider Novartis Phase II study ankylosing spondylitis comparing Novartis test treatment secukinumab placebo [2]. primary efficacy endpoint percentage patients 20% response according Assessment SpondyloArthritis international Society criteria improvement (ASAS20) week 6. control group, following historical data used derive MAP prior: dataset part RBesT available loading package data frame . RBesT supports required steps design clinical trial historical information using MAP approach.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"meta-analytic-predictive-analysis","dir":"Articles","previous_headings":"Prior Derivation","what":"Meta-Analytic-Predictive Analysis","title":"Getting started with RBesT (binary)","text":"gMAP function performs meta-analysis prediction, yields MAP prior. analysis run using stochastic Markov-Chain-Monte-Carlo Stan. order make results exactly reproducible, set.seed function must called prior calling gMAP . key parameter meta-analysis -trial heterogeneity parameter \\(\\tau\\) controls amount borrowing historical information estimation population mean occur. often historical trials, prior important. binary endpoints expected response rate 20%-80% recommend conservative HalfNormal(0,1) prior default. Please refer help-page gMAP information. gMAP function returns analysis object can extract information using functions RBesT. recommend look graphical model checks provided RBesT demonstrated . important one forest plot, solid lines MAP model predictions dashed lines stratified estimates. standard forest plot without shrinkage estimates please refer forest_plot function RBesT.  often raised concern Bayesian analysis choice prior. Hence sensitivity analyses may sometimes necessary. can quickly performed update function. Suppose want evaluate optimistic scenario (less -trial heterogeneity), expressed HalfNormal(0,1/2) prior \\(\\tau\\). can rerun original analysis, modified arguments gMAP:","code":"# load R packages library(RBesT) library(ggplot2) theme_set(theme_bw()) # sets up plotting theme  set.seed(34563) map_mcmc <- gMAP(cbind(r, n-r) ~ 1 | study,                  data=AS,                  tau.dist=\"HalfNormal\",                  tau.prior=1,                  beta.prior=2,                  family=binomial) ## Assuming default prior location   for beta: 0 print(map_mcmc) ## Generalized Meta Analytic Predictive Prior Analysis ##  ## Call:  gMAP(formula = cbind(r, n - r) ~ 1 | study, family = binomial,  ##     data = AS, tau.dist = \"HalfNormal\", tau.prior = 1, beta.prior = 2) ##  ## Exchangeability tau strata: 1  ## Prediction tau stratum    : 1  ## Maximal Rhat              : 1  ##  ## Between-trial heterogeneity of tau prediction stratum ##   mean     sd   2.5%    50%  97.5%  ## 0.3770 0.2170 0.0414 0.3460 0.8930  ##  ## MAP Prior MCMC sample ##   mean     sd   2.5%    50%  97.5%  ## 0.2580 0.0842 0.1120 0.2510 0.4590 ## a graphical representation of model checks is available pl <- plot(map_mcmc)  ## a number of plots are immediately defined names(pl) ## [1] \"densityThetaStar\"     \"densityThetaStarLink\" \"forest_model\" ## forest plot with model estimates print(pl$forest_model) set.seed(36546) map_mcmc_sens <- update(map_mcmc, tau.prior=1/2) ## Assuming default prior location   for beta: 0 print(map_mcmc_sens) ## Generalized Meta Analytic Predictive Prior Analysis ##  ## Call:  gMAP(formula = cbind(r, n - r) ~ 1 | study, family = binomial,  ##     data = AS, tau.dist = \"HalfNormal\", tau.prior = 1/2, beta.prior = 2) ##  ## Exchangeability tau strata: 1  ## Prediction tau stratum    : 1  ## Maximal Rhat              : 1  ##  ## Between-trial heterogeneity of tau prediction stratum ##   mean     sd   2.5%    50%  97.5%  ## 0.3340 0.1740 0.0368 0.3130 0.7180  ##  ## MAP Prior MCMC sample ##   mean     sd   2.5%    50%  97.5%  ## 0.2550 0.0787 0.1170 0.2470 0.4380"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"parametric-approximation","dir":"Articles","previous_headings":"Prior Derivation","what":"Parametric Approximation","title":"Getting started with RBesT (binary)","text":"next step, MAP prior, represented numerically using large MCMC simulation sample, converted parametric representation automixfit function. function fits parametric mixture representation using expectation-maximization (EM). number mixture components best describe MAP chosen automatically. , plot function produces graphical diagnostic allows user assess whether marginal mixture density (shown black) matches well histogram MAP MCMC sample.","code":"map <- automixfit(map_mcmc) print(map) ## EM for Beta Mixture Model ## Log-Likelihood = 4523.865 ##  ## Univariate beta mixture ## Mixture Components: ##   comp1      comp2      ## w  0.6167463  0.3832537 ## a 19.1916387  3.5278745 ## b 57.7779317  9.3735980 plot(map)$mix"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"effective-sample-size","dir":"Articles","previous_headings":"Prior Derivation","what":"Effective Sample Size","title":"Getting started with RBesT (binary)","text":"(usual) intended use (MAP) prior reduce number control patients trial. prior can considered equivalent number experimental observations, called effective sample size (ESS) prior. can calculated RBesT ess function. noted, however, concept ESS somewhat elusive. particular, definition ESS unique multiple methods therefore implemented RBesT. default method RBesT elir approach [5] results reasonable ESS estimates. moment matching approach leads conservative (small) ESS estimates Morita [3] method tends estimates liberal (large) ESS estimates used mixtures: Morita approach uses curvature prior mode found sensitive large number mixture components. experience, realistic ESS estimate can obtained elir method method predictively consistent, see [5] details.","code":"round(ess(map, method=\"elir\"))   ## default method ## [1] 37 round(ess(map, method=\"moment\")) ## [1] 26 round(ess(map, method=\"morita\")) ## [1] 63"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"robustification-of-the-map-prior","dir":"Articles","previous_headings":"Prior Derivation","what":"Robustification of the MAP Prior","title":"Getting started with RBesT (binary)","text":"Finally, recommend robustify [4] prior protects type-error inflation presence prior-data conflict, .e. future trial data strongly deviate historical control information. Adding robust mixture component reduce ESS MAP prior extent depends weight robust component. Selecting higher robust mixture weights leads greater discounting informative MAP prior vice versa. consequence robust weight controls degree influence MAP prior within final analysis. circumstances can helpful graphically illustrate relationship prior ESS function robust mixture component weight:","code":"## add a 20% non-informative mixture component map_robust <- robustify(map, weight=0.2, mean=1/2) print(map_robust) ## Univariate beta mixture ## Mixture Components: ##   comp1     comp2     robust    ## w  0.493397  0.306603  0.200000 ## a 19.191639  3.527874  1.000000 ## b 57.777932  9.373598  1.000000 round(ess(map_robust)) ## [1] 26 ess_weight <- data.frame(weight=seq(0.05, 0.95, by=0.05), ess=NA) for(i in seq_along(ess_weight$weight)) {     ess_weight$ess[i] <- ess(robustify(map, ess_weight$weight[i], 0.5)) } ess_weight <- rbind(ess_weight,                     data.frame(weight=c(0, 1),                                ess=c(ess(map), ess(mixbeta(c(1,1,1))))))  qplot(weight, ess, data=ess_weight, geom=c(\"point\", \"line\"),       main=\"ESS of robust MAP for varying weight of robust component\") +     scale_x_continuous(breaks=seq(0,  1, by=0.1)) +     scale_y_continuous(breaks=seq(0, 40, by=5)) ## Warning: `qplot()` was deprecated in ggplot2 3.4.0."},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"design-evaluation","dir":"Articles","previous_headings":"","what":"Design Evaluation","title":"Getting started with RBesT (binary)","text":"Now prior can specified protocol. advantage using historical information possible reduction placebo patient group. sample size control group supplemented historical information. reduction placebo patients can large ESS MAP prior. following, compare designs different sample sizes priors control group. comparisons carried evaluating standard Frequentist operating characteristics (type-error, power). scenarios exhaustive, rather specific ones demonstrate use RBesT design evaluation.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"operating-characteristics","dir":"Articles","previous_headings":"Design Evaluation","what":"Operating Characteristics","title":"Getting started with RBesT (binary)","text":"consider 2-arm design actual Novartis trial ankylosing spondylitis [2]. trial tested 6 patients placebo control 24 patients active experimental treatment. Success declared whenever condition \\[\\Pr(\\theta_{active} - \\theta_{control} > 0) > 0.95\\] met response rates \\(\\theta_{active}\\) \\(\\theta_{control}\\). MAP prior used placebo response rate parameter. evaluate design options example. operating characteristics setup RBesT stepwise manner: Definition priors arm. Definition decision criterion using decision2S function. Specification design options oc2S function. includes overall decision function per arm prior sample size use. object step 3 used calculate operating characteristics. Note 1-sample situation respective decision1S oc1S function used instead.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"type-i-error","dir":"Articles","previous_headings":"Design Evaluation > Operating Characteristics","what":"Type I Error","title":"Getting started with RBesT (binary)","text":"type can increased compared nominal \\(\\alpha\\) level case conflict trial data prior. Note, example MAP prior 95% interval 0.1 0.5.  Note observing response rates greater 50% highly implausible based MAP analysis: Hence, resonable restrict response rates \\(\\theta\\) evaluate type error range plausible values:","code":"theta         <- seq(0.1,0.95,by=0.01) uniform_prior <- mixbeta(c(1,1,1)) treat_prior   <- mixbeta(c(1,0.5,1)) # prior for treatment used in trial lancet_prior  <- mixbeta(c(1,11,32)) # prior for control   used in trial decision      <- decision2S(0.95, 0, lower.tail=FALSE)  design_uniform   <- oc2S(uniform_prior, uniform_prior, 24,  6, decision) design_classic   <- oc2S(uniform_prior, uniform_prior, 24, 24, decision) design_nonrobust <- oc2S(treat_prior,   map          , 24,  6, decision) design_robust    <- oc2S(treat_prior,   map_robust   , 24,  6, decision)  typeI_uniform   <- design_uniform(  theta, theta) typeI_classic   <- design_classic(  theta, theta) typeI_nonrobust <- design_nonrobust(theta, theta) typeI_robust    <- design_robust(   theta, theta)  ocI <- rbind(data.frame(theta=theta, typeI=typeI_robust,    prior=\"robust\"),              data.frame(theta=theta, typeI=typeI_nonrobust, prior=\"non-robust\"),              data.frame(theta=theta, typeI=typeI_uniform,   prior=\"uniform\"),              data.frame(theta=theta, typeI=typeI_classic,   prior=\"uniform 24:24\")              )  qplot(theta, typeI, data=ocI, colour=prior, geom=\"line\", main=\"Type I Error\") summary(map) ##       mean         sd       2.5%      50.0%      97.5%  ## 0.25857963 0.08423297 0.10808237 0.25003652 0.47028444 qplot(theta, typeI, data=subset(ocI, theta < 0.5), colour=prior, geom=\"line\",       main=\"Type I Error - response rate restricted to plausible range\")"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"power","dir":"Articles","previous_headings":"Design Evaluation > Operating Characteristics","what":"Power","title":"Getting started with RBesT (binary)","text":"power demonstrates gain using informative prior; .e. 80% power reached smaller \\(\\delta\\) values comparison design non-informative priors arms.  see MAP prior one reaches greater power smaller differences \\(\\delta\\) response rate. example, \\(\\delta\\) 80% power reached can found :","code":"delta <- seq(0,0.7,by=0.01) mean_control <- summary(map)[\"mean\"] theta_active  <- mean_control +   delta theta_control <- mean_control + 0*delta  power_uniform   <- design_uniform(  theta_active, theta_control) power_classic   <- design_classic(  theta_active, theta_control) power_nonrobust <- design_nonrobust(theta_active, theta_control) power_robust    <- design_robust(   theta_active, theta_control)  ocP <- rbind(data.frame(theta_active, theta_control, delta=delta, power=power_robust,    prior=\"robust\"),              data.frame(theta_active, theta_control, delta=delta, power=power_nonrobust, prior=\"non-robust\"),              data.frame(theta_active, theta_control, delta=delta, power=power_uniform,   prior=\"uniform\"),              data.frame(theta_active, theta_control, delta=delta, power=power_classic,   prior=\"uniform 24:24\")              )  qplot(delta, power, data=ocP, colour=prior, geom=\"line\", main=\"Power\") find_delta <- function(design, theta_control, target_power) {     uniroot(function(delta) { design(theta_control + delta, theta_control) - target_power },             interval=c(0, 1-theta_control))$root }  target_effect <- data.frame(delta=c(find_delta(design_nonrobust, mean_control, 0.8),                                     find_delta(design_classic,   mean_control, 0.8),                                     find_delta(design_robust,    mean_control, 0.8),                                                                         find_delta(design_uniform,   mean_control, 0.8)),                             prior=c(\"non-robust\", \"uniform 24:24\", \"robust\", \"uniform\"))  knitr::kable(target_effect, digits=3)"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"data-scenarios","dir":"Articles","previous_headings":"Design Evaluation > Operating Characteristics","what":"Data Scenarios","title":"Getting started with RBesT (binary)","text":"alternative approach visualize study design non-statisticians considering data scenarios. show decisions based potential trial outcomes. information needed critical values decision criterion flips. 2-sample case means calculate decision boundary, see decision2S_boundary help information.  graph shows decision always negative less 10 events treatment group. hand, non-robust prior assuming 15 events treatment group, three (less) placebo events needed success. check result, can directly evaluate decision function:","code":"## Critical values at which the decision flips are given conditional ## on the outcome of the second read-out; as we like to have this as a ## function of the treatment group outcome, we flip label 1 and 2 decision_flipped <- decision2S(0.95, 0, lower.tail=TRUE) crit_uniform     <- decision2S_boundary(uniform_prior, uniform_prior, 6, 24, decision_flipped) crit_nonrobust   <- decision2S_boundary(map          , treat_prior  , 6, 24, decision_flipped) crit_robust      <- decision2S_boundary(map_robust   , treat_prior  , 6, 24, decision_flipped) treat_y2 <- 0:24 ## Note that -1 is returned to indicated that the decision is never 1 ocC <- rbind(data.frame(y2=treat_y2, y1_crit=crit_robust(treat_y2),    prior=\"robust\"),              data.frame(y2=treat_y2, y1_crit=crit_nonrobust(treat_y2), prior=\"non-robust\"),              data.frame(y2=treat_y2, y1_crit=crit_uniform(treat_y2),   prior=\"uniform\")              )  qplot(y2, y1_crit, data=ocC, colour=prior, geom=\"step\", main=\"Critical values y1(y2)\") ## just positive decision(postmix(treat_prior, n=24, r=15), postmix(map, n=6, r=3)) ## [1] 1 ## negative decision(postmix(treat_prior, n=24, r=14), postmix(map, n=6, r=4)) ## [1] 0"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"trial-analysis","dir":"Articles","previous_headings":"","what":"Trial Analysis","title":"Getting started with RBesT (binary)","text":"trial completed data collected, final analysis can run RBesT using postmix function. Calculations performed analytically conjugate mixture setting.","code":"r_placebo <- 1 r_treat   <- 14  ## first obtain posterior distributions... post_placebo <- postmix(map_robust,  r=r_placebo, n=6) post_treat   <- postmix(treat_prior, r=r_treat  , n=24)  ## ...then calculate probability that the difference is smaller than ## zero prob_smaller <- pmixdiff(post_treat, post_placebo,  0, lower.tail=FALSE)  prob_smaller ## [1] 0.9913233 prob_smaller > 0.95 ## [1] TRUE ## alternativley we can use the decision object decision(post_treat, post_placebo) ## [1] 1"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"references","dir":"Articles","previous_headings":"Trial Analysis","what":"References","title":"Getting started with RBesT (binary)","text":"[1] Neuenschwander B. et al., Clin Trials. 2010; 7(1):5-18 [2] Baeten D. et al., Lancet, 2013, (382), 9906, p 1705 [3] Morita S. et al., Biometrics 2008;64(2):595-602 [4] Schmidli H. et al., Biometrics 2014;70(4):1023-1032 [5] Neuenschwander B. et al., Biometrics 2020;76(2):578-587","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/introduction.html","id":"r-session-info","dir":"Articles","previous_headings":"Trial Analysis","what":"R Session Info","title":"Getting started with RBesT (binary)","text":"","code":"sessionInfo() ## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggplot2_3.4.0 knitr_1.42    RBesT_1.6-5   ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           plyr_1.8.8           ## [10] R6_2.5.1             backports_1.4.1      stats4_4.2.2         ## [13] evaluate_0.20        highr_0.10           pillar_1.8.1         ## [16] rlang_1.0.6          callr_3.7.3          jquerylib_0.1.4      ## [19] checkmate_2.1.0      rmarkdown_2.20       pkgdown_2.0.7        ## [22] labeling_0.4.2       textshaping_0.3.6    desc_1.4.2           ## [25] stringr_1.5.0        loo_2.5.1            munsell_0.5.0        ## [28] compiler_4.2.2       xfun_0.37            rstan_2.21.8         ## [31] pkgconfig_2.0.3      systemfonts_1.0.4    pkgbuild_1.4.0       ## [34] rstantools_2.2.0     htmltools_0.5.4      tidyselect_1.2.0     ## [37] tensorA_0.36.2       tibble_3.1.8         gridExtra_2.3        ## [40] codetools_0.2-18     matrixStats_0.63.0   fansi_1.0.4          ## [43] withr_2.5.0          crayon_1.5.2         dplyr_1.1.0          ## [46] distributional_0.3.1 grid_4.2.2           jsonlite_1.8.4       ## [49] gtable_0.3.1         lifecycle_1.0.3      posterior_1.3.1      ## [52] magrittr_2.0.3       StanHeaders_2.21.0-7 scales_1.2.1         ## [55] RcppParallel_5.1.6   cli_3.6.0            stringi_1.7.12       ## [58] cachem_1.0.6         farver_2.1.1         reshape2_1.4.4       ## [61] fs_1.6.1             bslib_0.4.2          ragg_1.2.5           ## [64] generics_0.1.3       vctrs_0.5.2          Formula_1.2-4        ## [67] tools_4.2.2          glue_1.6.2           purrr_1.0.1          ## [70] abind_1.4-5          processx_3.8.0       parallel_4.2.2       ## [73] fastmap_1.1.0        yaml_2.3.7           inline_0.3.19        ## [76] colorspace_2.1-0     bayesplot_1.10.0     memoise_2.0.1        ## [79] sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"RBesT for a Normal Endpoint","text":"R Bayesian evidence synthesis Tools (RBesT) created facilitate use historical information clinical trials. relevant historical information identified, RBesT supports derivation informative priors via Meta-Analytic-Predictive (MAP) approach [1], evaluation trial’s operating characteristics, data analysis actual trial data. RBesT developed endpoints number well known distributions. consider example normally distributed response variable.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"historical-data","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Historical Data","title":"RBesT for a Normal Endpoint","text":"Let’s look Crohn’s disease example data [2] (data-set crohn RBesT). primary endpoint change baseline Crohn’s Disease Activity Index (CDAI), assumed normally distributed. Note CDAI, improved outcome corresponds negative change baseline. First historical studies get estimated standard deviation response variable \\(\\sigma\\) = 88, used obtain standard errors effect estimates.","code":"dat <- crohn crohn_sigma <- 88 dat$y.se <- crohn_sigma/sqrt(dat$n)"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"derivation-of-map-prior","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Derivation of MAP Prior","title":"RBesT for a Normal Endpoint","text":"MAP prior can derived function gMAP. -trial heterogeneity parameter \\(\\tau\\) governs much information shared historical trials design analysis future trials. normal case known sampling standard deviation \\(\\sigma\\), amount borrowing historical data depends ratio \\(\\tau/\\sigma\\). conservative choice prior \\(\\tau\\) HalfNormal(0, \\(\\sigma/2\\)) distribution. prior intercept recommend “unit-information” prior [3] set precision corresponding single observation centered change baseline. Please refer help page ?gMAP detailed information. set.seed function used make results exactly reproducible.","code":"library(RBesT) set.seed(689654) map_mcmc <- gMAP(cbind(y, y.se) ~ 1 | study,                   weights=n,data=dat,                  family=gaussian,                  beta.prior=cbind(0, crohn_sigma),                  tau.dist=\"HalfNormal\",tau.prior=cbind(0,crohn_sigma/2)) print(map_mcmc) ## Generalized Meta Analytic Predictive Prior Analysis ##  ## Call:  gMAP(formula = cbind(y, y.se) ~ 1 | study, family = gaussian,  ##     data = dat, weights = n, tau.dist = \"HalfNormal\", tau.prior = cbind(0,  ##         crohn_sigma/2), beta.prior = cbind(0, crohn_sigma)) ##  ## Exchangeability tau strata: 1  ## Prediction tau stratum    : 1  ## Maximal Rhat              : 1  ## Estimated reference scale : 88  ##  ## Between-trial heterogeneity of tau prediction stratum ##  mean    sd  2.5%   50% 97.5%  ## 14.50 10.00  1.19 12.50 39.20  ##  ## MAP Prior MCMC sample ##  mean    sd  2.5%   50% 97.5%  ## -50.0  19.2 -91.6 -48.7 -13.4 ## a graphical representation is also available pl <- plot(map_mcmc)  ## a number of plots are immediately defined names(pl) ## [1] \"densityThetaStar\"     \"densityThetaStarLink\" \"forest_model\" ## forest plot with model estimates print(pl$forest_model)"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"approximation-of-map-prior-using-a-mixture-distribution","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Approximation of MAP Prior using a Mixture Distribution","title":"RBesT for a Normal Endpoint","text":"Next, MCMC MAP prior previous section converted parametric representation automixfit function. function fits parametric mixture representation using expectation-maximization (EM). number mixture components chosen automatically using AIC. One can also specify number components mixture via mixfit function compare automixfit outcome.","code":"map <- automixfit(map_mcmc) print(map) ## EM for Normal Mixture Model ## Log-Likelihood = -17007.44 ##  ## Univariate normal mixture ## Reference scale: 88 ## Mixture Components: ##   comp1        comp2        comp3        ## w   0.50211765   0.47187303   0.02600932 ## m -52.87773410 -47.33641569 -43.90720135 ## s  21.87731545   7.73071395  59.70377117 ## check accuracy of mixture fit plot(map)$mix"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"effective-sample-size-ess","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Effective Sample Size (ESS)","title":"RBesT for a Normal Endpoint","text":"main advantage using historical information possibility reduce number control patients, informative prior effectively equivalent certain number control patients. called effective sample size (ESS) can calculated RBesT ess function. study protocol Crohn’s disease data example, conservative moment-based ESS 20 used reduce planned sample size control group.","code":"round(ess(map))                  ## default elir method ## Using default prior reference scale 88 ## [1] 42 round(ess(map, method=\"morita\")) ## Using default prior reference scale 88 ## [1] 98 round(ess(map, method=\"moment\")) ## Using default prior reference scale 88 ## [1] 21"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"robustification-of-map-prior","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Robustification of MAP Prior","title":"RBesT for a Normal Endpoint","text":"recommend robustifying [5] prior robustify function, protects type-error inflation presence prior-data conflict. normal case strongly recommend explicitly choosing mean robust component. use \\(-50\\) consistent mean MAP prior. Furthermore, 20% probability used additional robust (unit-information) mixture component. choice probability reflects confidence validitiy model assumptions, .e. possibility non-exchangable control group enrolled per inclusion/exclusion criteria current trial compared historical control group population. Note robustification decreases ESS.","code":"## add a 20% non-informative mixture component map_robust <- robustify(map, weight=0.2, mean=-50) ## Using default prior reference scale 88 print(map_robust) ## Univariate normal mixture ## Reference scale: 88 ## Mixture Components: ##   comp1        comp2        comp3        robust       ## w   0.40169412   0.37749842   0.02080745   0.20000000 ## m -52.87773410 -47.33641569 -43.90720135 -50.00000000 ## s  21.87731545   7.73071395  59.70377117  88.00000000 round(ess(map_robust)) ## Using default prior reference scale 88 ## [1] 31"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"operating-characteristics-of-design-options","dir":"Articles","previous_headings":"Trial Design with Historical Control Data","what":"Operating Characteristics of Design Options","title":"RBesT for a Normal Endpoint","text":"Typically, operating characteristics required evaluate proposed design compare design options. RBesT requires input decision rules via decision2S function calculates operating characteristics oc2S function. calculation expedited based analytic expressions. following compare design options, differ choice control priors sample size control group planned trial. may design factors (outcome standard deviation), considered comparing design options. factors considered simplicity purpose.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"decision-rules","dir":"Articles","previous_headings":"Trial Design with Historical Control Data > Operating Characteristics of Design Options","what":"Decision Rules","title":"RBesT for a Normal Endpoint","text":"Consider 2-arm design placebo (informative prior) experimental treatment. dual-criterion success defined follows: \\[ \\begin{align*} \\textrm{Criterion 1:} &  \\Pr(\\theta_{act} - \\theta_{pbo} \\lt 0) &> 0.95 \\\\ \\textrm{Criterion 2:} & \\Pr(\\theta_{act} - \\theta_{pbo} \\lt -50) &> 0.50. \\end{align*} \\] Equivalently, second criterion requires posterior median difference exceeds -50. dual-criteria account statistical significance well clinical relevance. Note negative change baseline CDAI corresponds improvement.","code":"## dual decision criteria ## pay attention to \"lower.tail\" argument and the order of active and pbo poc <- decision2S(pc=c(0.95,0.5), qc=c(0,-50), lower.tail=TRUE) print(poc) ## 2 sample decision function ## Conditions for acceptance: ## P(theta1 - theta2 <= 0) > 0.95 ## P(theta1 - theta2 <= -50) > 0.5 ## Link: identity"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"design-options","dir":"Articles","previous_headings":"Trial Design with Historical Control Data > Operating Characteristics of Design Options","what":"Design Options","title":"RBesT for a Normal Endpoint","text":"active group use weakly informative (unit-information) prior used robustification step MAP prior. Also, set design options different choices control prior different sizes control group.","code":"## set up prior for active group weak_prior <- mixnorm(c(1,-50,1), sigma=crohn_sigma, param = 'mn') n_act <- 40 n_pbo <- 20  ## four designs ## \"b\" means a balanced design, 1:1 ## \"ub\" means 40 in active and 20 in placebo design_noprior_b  <- oc2S(weak_prior, weak_prior, n_act, n_act, poc,                           sigma1=crohn_sigma, sigma2=crohn_sigma) design_noprior_ub <- oc2S(weak_prior, weak_prior, n_act, n_pbo, poc,                           sigma1=crohn_sigma, sigma2=crohn_sigma) design_nonrob_ub  <- oc2S(weak_prior, map, n_act, n_pbo, poc,                           sigma1=crohn_sigma, sigma2=crohn_sigma) design_rob_ub     <- oc2S(weak_prior, map_robust, n_act, n_pbo, poc,                           sigma1=crohn_sigma, sigma2=crohn_sigma)"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"type-i-error","dir":"Articles","previous_headings":"Trial Design with Historical Control Data > Operating Characteristics of Design Options","what":"Type I Error","title":"RBesT for a Normal Endpoint","text":"type can increased compared nominal \\(\\alpha\\) level case conflict trial data prior. robustified MAP prior can reduce type error inflation case lower level.","code":"# the range for true values cfb_truth <- seq(-120, -40, by=1)  typeI1 <- design_noprior_b(cfb_truth, cfb_truth) typeI2 <- design_noprior_ub(cfb_truth, cfb_truth) typeI3 <- design_nonrob_ub(cfb_truth, cfb_truth) typeI4 <- design_rob_ub(cfb_truth, cfb_truth)  ocI <- rbind(data.frame(cfb_truth=cfb_truth, typeI=typeI1,                         design=\"40:40 with non-informative priors\"),              data.frame(cfb_truth=cfb_truth, typeI=typeI2,                         design=\"40:20 with non-informative priors\"),              data.frame(cfb_truth=cfb_truth, typeI=typeI3,                         design=\"40:20 with non-robust prior for placebo\"),              data.frame(cfb_truth=cfb_truth, typeI=typeI4,                         design=\"40:20 with robust prior for placebo\") ) qplot(cfb_truth, typeI, data=ocI, colour=design, geom=\"line\", main=\"Type I Error\") +     xlab(expression(paste('True value of change from baseline ', mu[act] == mu[pbo]))) +         ylab('Type I error') +             coord_cartesian(ylim=c(0,0.2)) +   theme(legend.justification=c(1,1),legend.position=c(0.95,0.85)) ## Warning: `qplot()` was deprecated in ggplot2 3.4.0."},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"power","dir":"Articles","previous_headings":"Trial Design with Historical Control Data > Operating Characteristics of Design Options","what":"Power","title":"RBesT for a Normal Endpoint","text":"power shows gain using informative prior control arm; .e. 90% power reached smaller \\(\\delta\\) values compared design weakly informative priors arms balanced design.","code":"delta <- seq(-80,0,by=1) m <- summary(map)[\"mean\"] cfb_truth1 <- m + delta   # active for 1 cfb_truth2 <- m + 0*delta # pbo for 2  power1 <- design_noprior_b(cfb_truth1, cfb_truth2) power2 <- design_noprior_ub(cfb_truth1, cfb_truth2) power3 <- design_nonrob_ub(cfb_truth1, cfb_truth2) power4 <- design_rob_ub(cfb_truth1, cfb_truth2)  ocP <- rbind(data.frame(cfb_truth1=cfb_truth1, cfb_truth2=cfb_truth2,                         delta=delta, power=power1,                         design=\"40:40 with non-informative priors\"),              data.frame(cfb_truth1=cfb_truth1, cfb_truth2=cfb_truth2,                         delta=delta, power=power2,                         design=\"40:20 with non-informative priors\"),              data.frame(cfb_truth1=cfb_truth1, cfb_truth2=cfb_truth2,                         delta=delta, power=power3,                         design=\"40:20 with non-robust prior for placebo\"),              data.frame(cfb_truth1=cfb_truth1, cfb_truth2=cfb_truth2,                         delta=delta, power=power4,                         design=\"40:20 with robust prior for placebo\") )  qplot(delta, power, data=ocP, colour=design, geom=\"line\", main=\"Power\") +   xlab('True value of difference (act - pbo)')+ ylab('Power') +   scale_y_continuous(breaks=c(seq(0,1,0.2),0.9)) +   scale_x_continuous(breaks=c(seq(-80,0,20),-70)) +   geom_hline(yintercept=0.9,linetype=2) +    geom_vline(xintercept=-70,linetype=2) +   theme(legend.justification=c(1,1),legend.position=c(0.95,0.85))"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"final-analysis-with-trial-data","dir":"Articles","previous_headings":"","what":"Final Analysis with Trial Data","title":"RBesT for a Normal Endpoint","text":"actual trial data available, final analysis can run RBesT via postmix function. real data used example, trial data led negative conclusion. However, note postmix assumes sampling standard deviation known fixed. Therefore, uncertainty estimate taken account.","code":"## one can either use summary data or individual data. See ?postmix. y.act <- -29.2 y.act.se <- 14.0 n.act <- 39  y.pbo <- -63.1 y.pbo.se <- 13.9 n.pbo <- 20  ## first obtain posterior distributions post_act <- postmix(weak_prior, m=y.act, se=y.act.se) post_pbo <- postmix(map_robust, m=y.pbo, se=y.pbo.se)  ## then calculate probability for the dual criteria ## and compare to the predefined threshold values p1 <- pmixdiff(post_act, post_pbo, 0); print(p1) ## [1] 0.06315548 p2 <- pmixdiff(post_act, post_pbo, -50); print(p2) ## [1] 3.725917e-06 print(p1>0.95 & p2>0.5) ## [1] FALSE ## or we can use the decision function poc(post_act, post_pbo) ## [1] 0"},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"references","dir":"Articles","previous_headings":"Final Analysis with Trial Data","what":"References","title":"RBesT for a Normal Endpoint","text":"[1] Neuenschwander B et. al, Clin Trials. 2010; 7(1):5-18 [2] Hueber W. et. al, Gut, 2012, 61(12):1693-1700 [3] Kass RE, Wasserman L, J Amer Statist Assoc; 1995, 90(431):928-934. [4] Morita S. et. al, Biometrics 2008;64(2):595-602 [5] Schmidli H. et. al, Biometrics 2014;70(4):1023-1032","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/introduction_normal.html","id":"r-session-info","dir":"Articles","previous_headings":"Final Analysis with Trial Data","what":"R Session Info","title":"RBesT for a Normal Endpoint","text":"","code":"sessionInfo() ## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] knitr_1.42    ggplot2_3.4.0 RBesT_1.6-5   ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           plyr_1.8.8           ## [10] R6_2.5.1             backports_1.4.1      stats4_4.2.2         ## [13] evaluate_0.20        highr_0.10           pillar_1.8.1         ## [16] rlang_1.0.6          callr_3.7.3          jquerylib_0.1.4      ## [19] checkmate_2.1.0      rmarkdown_2.20       pkgdown_2.0.7        ## [22] labeling_0.4.2       textshaping_0.3.6    desc_1.4.2           ## [25] stringr_1.5.0        loo_2.5.1            munsell_0.5.0        ## [28] compiler_4.2.2       xfun_0.37            rstan_2.21.8         ## [31] pkgconfig_2.0.3      systemfonts_1.0.4    pkgbuild_1.4.0       ## [34] rstantools_2.2.0     htmltools_0.5.4      tidyselect_1.2.0     ## [37] tensorA_0.36.2       tibble_3.1.8         gridExtra_2.3        ## [40] codetools_0.2-18     matrixStats_0.63.0   fansi_1.0.4          ## [43] withr_2.5.0          crayon_1.5.2         dplyr_1.1.0          ## [46] distributional_0.3.1 grid_4.2.2           jsonlite_1.8.4       ## [49] gtable_0.3.1         lifecycle_1.0.3      posterior_1.3.1      ## [52] magrittr_2.0.3       StanHeaders_2.21.0-7 scales_1.2.1         ## [55] RcppParallel_5.1.6   cli_3.6.0            stringi_1.7.12       ## [58] cachem_1.0.6         farver_2.1.1         reshape2_1.4.4       ## [61] fs_1.6.1             bslib_0.4.2          ragg_1.2.5           ## [64] generics_0.1.3       vctrs_0.5.2          Formula_1.2-4        ## [67] tools_4.2.2          glue_1.6.2           purrr_1.0.1          ## [70] abind_1.4-5          processx_3.8.0       parallel_4.2.2       ## [73] fastmap_1.1.0        yaml_2.3.7           inline_0.3.19        ## [76] colorspace_2.1-0     bayesplot_1.10.0     memoise_2.0.1        ## [79] sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/articles/variances_MAP.html","id":"map-prior-for-the-sampling-standard-deviation","dir":"Articles","previous_headings":"","what":"MAP prior for the sampling standard deviation","title":"Meta-Analytic-Predictive Priors for Variances","text":"MAP analysis performed \\(\\log\\) variance, actually interested MAP respective sampling standard deviation. Since sampling standard deviation strictly positive quantity suitable approximate MCMC posterior MAP prior using mixture \\(\\Gamma\\) variates, can done using RBesT :","code":"map_mc_post <- as.matrix(map_mc) sd_trans <- compose(sqrt, exp) mcmc_intervals(map_mc_post, regex_pars=\"theta\", transformation=sd_trans) map_sigma_mc <- sd_trans(map_mc_post[,c(\"theta_pred\")]) map_sigma <- automixfit(map_sigma_mc, type=\"gamma\")  plot(map_sigma)$mix ## 95% interval MAP for the sampling standard deviation summary(map_sigma) ##      mean        sd      2.5%     50.0%     97.5%  ## 10.962936  1.393477  8.338368 10.903531 13.966982"},{"path":"http://opensource.nibr.com/RBesT/articles/variances_MAP.html","id":"normal-approximation-of-a-loggamma-variate","dir":"Articles","previous_headings":"","what":"Normal approximation of a \\(\\log\\Gamma\\) variate","title":"Meta-Analytic-Predictive Priors for Variances","text":"\\(\\Gamma(y|\\alpha, \\beta)\\) variate \\(y\\), \\(\\log\\) transformed, \\(z = \\log(y)\\), law transformations univariate densities: \\[ y|\\alpha,\\beta \\sim \\Gamma(\\alpha,\\beta) \\] \\[ p(z) = p(y) \\, y = p(\\exp(z)) \\, \\exp(z) \\] \\[ z|\\alpha,\\beta \\sim \\log\\Gamma(\\alpha,\\beta)\\] \\[\\Leftrightarrow \\exp(z)|\\alpha,\\beta \\sim \\Gamma(\\alpha,\\beta) \\, \\exp(z) \\] first second moment \\(z\\) \\[ E[z] = \\psi(\\alpha) - \\log(\\beta)\\] \\[ Var[z] = \\psi^{(1)}(\\alpha).\\] short simulation demonstrates results:  see \\(\\nu=9\\) , approximation normal density reasonable. However, comparing function \\(\\nu\\) \\(2.5\\)%, \\(50\\)% \\(97.5\\)% quantiles correct distribution respective approximate distribution can assess adequatness approximation. respective R code accessible via vignette overview page graphical result presented two different \\(\\sigma\\) values:","code":"gamma_dist <- mixgamma(c(1, 18, 6))  ## logGamma density dlogGamma <- function(z, a, b, log=FALSE) {     n <- exp(z)     if(!log) {         return(dgamma(n, a, b) * n)     } else {         return(dgamma(n, a, b, log=TRUE) + z)     } }  a <- gamma_dist[2,1] b <- gamma_dist[3,1] m <- digamma(a) - log(b) v <- psigamma(a,1)  ## compare simulated histogram of log transformed Gamma variates to ## analytic density and approximate normal sim <- rmix(gamma_dist, 1E5) mcmc_hist(data.frame(logGamma=log(sim)), freq=FALSE, binwidth=0.1) +     overlay_function(fun=dlogGamma, args=list(a=a,b=b), aes(linetype=\"LogGamma\")) +     overlay_function(fun=dnorm, args=list(mean=m, sd=sqrt(v)), aes(linetype=\"NormalApprox\"))"},{"path":"http://opensource.nibr.com/RBesT/articles/variances_MAP.html","id":"acknowledgements","dir":"Articles","previous_headings":"Normal approximation of a \\(\\log\\Gamma\\) variate","what":"Acknowledgements","title":"Meta-Analytic-Predictive Priors for Variances","text":"Many thanks Ping Chen Simon Wandel pointing issue transformation used earlier vignette.","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/variances_MAP.html","id":"references","dir":"Articles","previous_headings":"Normal approximation of a \\(\\log\\Gamma\\) variate","what":"References","title":"Meta-Analytic-Predictive Priors for Variances","text":"[1] Schmidli, H., et. al, Comp. Stat. Data Analysis, 2017, 113:100-110 [2] https://en.wikipedia.org/wiki/Gamma_distribution#Logarithmic_expectation_and_variance [3] Gelman , et. al, Bayesian Data Analysis. Third edit., 2014., Chapter 4, p. 84","code":""},{"path":"http://opensource.nibr.com/RBesT/articles/variances_MAP.html","id":"r-session-info","dir":"Articles","previous_headings":"Normal approximation of a \\(\\log\\Gamma\\) variate","what":"R Session Info","title":"Meta-Analytic-Predictive Priors for Variances","text":"","code":"sessionInfo() ## R version 4.2.2 (2022-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggplot2_3.4.0    bayesplot_1.10.0 knitr_1.42       purrr_1.0.1      ## [5] dplyr_1.1.0      RBesT_1.6-5      ##  ## loaded via a namespace (and not attached): ##  [1] Rcpp_1.0.10          mvtnorm_1.1-3        prettyunits_1.1.1    ##  [4] ps_1.7.2             assertthat_0.2.1     rprojroot_2.0.3      ##  [7] digest_0.6.31        utf8_1.2.3           plyr_1.8.8           ## [10] R6_2.5.1             backports_1.4.1      stats4_4.2.2         ## [13] evaluate_0.20        highr_0.10           pillar_1.8.1         ## [16] rlang_1.0.6          callr_3.7.3          jquerylib_0.1.4      ## [19] checkmate_2.1.0      rmarkdown_2.20       pkgdown_2.0.7        ## [22] labeling_0.4.2       textshaping_0.3.6    desc_1.4.2           ## [25] stringr_1.5.0        loo_2.5.1            munsell_0.5.0        ## [28] compiler_4.2.2       xfun_0.37            rstan_2.21.8         ## [31] pkgconfig_2.0.3      systemfonts_1.0.4    pkgbuild_1.4.0       ## [34] rstantools_2.2.0     htmltools_0.5.4      tidyselect_1.2.0     ## [37] tensorA_0.36.2       tibble_3.1.8         gridExtra_2.3        ## [40] codetools_0.2-18     matrixStats_0.63.0   fansi_1.0.4          ## [43] withr_2.5.0          crayon_1.5.2         distributional_0.3.1 ## [46] grid_4.2.2           jsonlite_1.8.4       gtable_0.3.1         ## [49] lifecycle_1.0.3      posterior_1.3.1      magrittr_2.0.3       ## [52] StanHeaders_2.21.0-7 scales_1.2.1         RcppParallel_5.1.6   ## [55] cli_3.6.0            stringi_1.7.12       cachem_1.0.6         ## [58] farver_2.1.1         reshape2_1.4.4       fs_1.6.1             ## [61] bslib_0.4.2          ragg_1.2.5           generics_0.1.3       ## [64] vctrs_0.5.2          Formula_1.2-4        tools_4.2.2          ## [67] glue_1.6.2           abind_1.4-5          processx_3.8.0       ## [70] parallel_4.2.2       fastmap_1.1.0        yaml_2.3.7           ## [73] inline_0.3.19        colorspace_2.1-0     memoise_2.0.1        ## [76] sass_0.4.5"},{"path":"http://opensource.nibr.com/RBesT/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Novartis Pharma AG. Copyright holder. Sebastian Weber. Author, maintainer. Beat Neuenschwander. Contributor. Heinz Schmidli. Contributor. Baldur Magnusson. Contributor. Yue Li. Contributor. Satrajit Roychoudhury. Contributor. Trustees Columbia University. Copyright holder.            R/stanmodels.R, configure, configure.win","code":""},{"path":"http://opensource.nibr.com/RBesT/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Weber S, Li Y, Seaman JW, Kakizume T, Schmidli H (2021). “Applying Meta-Analytic-Predictive Priors R Bayesian Evidence Synthesis Tools.” Journal Statistical Software, 100(19), 1–32. doi:10.18637/jss.v100.i19.","code":"@Article{,   title = {Applying Meta-Analytic-Predictive Priors with the {R} {B}ayesian Evidence Synthesis Tools},   author = {Sebastian Weber and Yue Li and John W. Seaman and Tomoyuki Kakizume and Heinz Schmidli},   journal = {Journal of Statistical Software},   year = {2021},   volume = {100},   number = {19},   pages = {1--32},   doi = {10.18637/jss.v100.i19}, }"},{"path":"http://opensource.nibr.com/RBesT/index.html","id":"rbest-r-bayesian-evidence-synthesis-tools","dir":"","previous_headings":"","what":"R Bayesian Evidence Synthesis Tools","title":"R Bayesian Evidence Synthesis Tools","text":"Tool-set support Bayesian evidence synthesis. includes meta-analysis, (robust) prior derivation historical data, operating characteristics analysis (1 2 sample cases). Please refer Weber et al. (2021) details applying package Neuenschwander et al. (2010) Schmidli et al. (2014) explain details methodology.","code":""},{"path":"http://opensource.nibr.com/RBesT/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"R Bayesian Evidence Synthesis Tools","text":"get quick overview package functionality, please refer introductory vignettes. recommend starting Getting started RBesT (binary) vignette first read.","code":""},{"path":"http://opensource.nibr.com/RBesT/index.html","id":"resources","dir":"","previous_headings":"","what":"Resources","title":"R Bayesian Evidence Synthesis Tools","text":"RBesT reference manual PDF (useful offline reading)","code":""},{"path":[]},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"bug-fixes-1-6-5","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"RBesT 1.6-5 - January 23rd, 2023","text":"ensure predict new studies sample study specifc random effect per iteration . important MAP priors covariate effects (pooled studies).","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-16-4---august-5th-2022","dir":"Changelog","previous_headings":"","what":"RBesT 1.6-4 - August 5th, 2022","title":"RBesT 1.6-4 - August 5th, 2022","text":"CRAN release: 2022-08-08","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"enhancements-1-6-4","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"RBesT 1.6-4 - August 5th, 2022","text":"use clustermq inplace batchtools SBC runs. Also use L’Ecuyer CMG random number gen SBC runs. expand introductory vignette plot ESS vs robust weight start using matrixStats speed EM algorithms & OCs avoid warning whenever 2S normal design expanded domain called repeatedly add mixdist plot plotting mixture resulting *mixfit call add warning message printing gMAP analysis Stan sampler issues due divergent transitions non-convergence indicated large Rhat","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"bug-fixes-1-6-4","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"RBesT 1.6-4 - August 5th, 2022","text":"mixture density evaluations (dmix) defined link function evaluate correctly, visible plotting mixtures (one component) link functions","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-16-3---november-23rd-2021","dir":"Changelog","previous_headings":"","what":"RBesT 1.6-3 - November 23rd, 2021","title":"RBesT 1.6-3 - November 23rd, 2021","text":"CRAN release: 2021-11-24 update references JSS publication","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-16-2---september-3rd-2021","dir":"Changelog","previous_headings":"","what":"RBesT 1.6-2 - September 3rd, 2021","title":"RBesT 1.6-2 - September 3rd, 2021","text":"CRAN release: 2021-09-03 link RcppParallel align new Stan requirements address CRAN comments","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-16-1---may-28th-2020","dir":"Changelog","previous_headings":"","what":"RBesT 1.6-1 - May 28th, 2020","title":"RBesT 1.6-1 - May 28th, 2020","text":"CRAN release: 2020-05-28 stabilize elir ESS integration integrating per mixture component comply forthcoming stricter stanc3 Stan transpiler address warnings ggplot2 3.3.0","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-16-0---march-27th-2020","dir":"Changelog","previous_headings":"","what":"RBesT 1.6-0 - March 27th, 2020","title":"RBesT 1.6-0 - March 27th, 2020","text":"CRAN release: 2020-03-28 fix CI system issues fix issues normal decision2S_boundary boundaries grown add demo 2S OC simulation code time--event endpoint constant hazard assumption drop tidyverse dependency expand SBC checks include group specifc estimates stop setting ggplot2 default theme loading package. plots now use bayesplot theme can modified bayesplot_theme_* functions. See ?bayesplot::bayesplot_theme_get. correct transformation issue MAP variances vignette - thanks Ping Chen allow constrained fitting beta mixtures & b parameters greater 1. new default behavior function inform . informational message removed future release. introduced new mixecdf plot diagnostic EM fits","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-15-4---october-22nd-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.5-4 - October 22nd, 2019","title":"RBesT 1.5-4 - October 22nd, 2019","text":"CRAN release: 2019-10-23 Now really fix n2=0 case 2S design functions indirect comparisons Update package structure new rstantools 2.0 system","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-15-3---august-28th-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.5-3 - August 28th, 2019","title":"RBesT 1.5-3 - August 28th, 2019","text":"CRAN release: 2019-08-28 Fix vignette MAP variances (missing definition)","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-15-2---august-28th-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.5-2 - August 28th, 2019","title":"RBesT 1.5-2 - August 28th, 2019","text":"Speedup example run time Avoid use cat functions use message instead Replace dontrun examples donttest Require NOT_CRAN=true tests run","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-15-1---august-28th-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.5-1 - August 28th, 2019","title":"RBesT 1.5-1 - August 28th, 2019","text":"Work around compiler warning clang fedora platform","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-15-0---august-15th-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.5-0 - August 15th, 2019","title":"RBesT 1.5-0 - August 15th, 2019","text":"Fix indirect comparisons work normal/Poisson/binomial (inexact) allow n2=0 oc2S calls. Make mixture quantile function robust work flat mixture priors. Align ESS Morita calculations Neuenschwander B. et al., pre-print 2019; arXiv:1907.04185","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-14-0---july-27th-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.4-0 - July 27th, 2019","title":"RBesT 1.4-0 - July 27th, 2019","text":"CRAN release: 2019-06-27 Introduce elir ESS method new default ESS Allow sample prior predictive gMAP (argument prior_PD) Switch internally ab parametrized version EM beta algorithm","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-8---april-3nd-2019","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-8 - April 3nd, 2019","title":"RBesT 1.3-8 - April 3nd, 2019","text":"CRAN release: 2019-04-04 Use Simulation Based Calibration gMAP model qualification Improve covariate handling (naming data items) Speedup Stan model avoiding matrix-vector products many zeros Fix index issue differential discounting used covariates Make initialization EM algorithms robust Avoid special build hacks MacOS","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-7---november-16th-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-7 - November 16th, 2018","title":"RBesT 1.3-7 - November 16th, 2018","text":"CRAN release: 2018-11-19 Address issue build process MacOS.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-6---november-14th-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-6 - November 14th, 2018","title":"RBesT 1.3-6 - November 14th, 2018","text":"CRAN release: 2018-11-15 Re-create vignettes proper MCMC sampling. Automate R package build process using CI/CD.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-5---november-13th-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-5 - November 13th, 2018","title":"RBesT 1.3-5 - November 13th, 2018","text":"CRAN release: 2018-11-14 Corrected 1.3-4 release notes include MAP variances vignette Make build process robust (updated src/Makevars{.win}) Added probability success interim vignette Added probability success co-data vignette","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-4---october-16th-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-4 - October 16th, 2018","title":"RBesT 1.3-4 - October 16th, 2018","text":"CRAN release: 2018-10-17 Make package work rstan 2.18.1. Revert BetaBinomial implementation back R functions. Bugfix decision1S_boundary normal case extreme parameter configurations (fixes pos1S & oc1S well). Bugfix mixcombine plot normal mixtures without sigma defined. Bugfix repeated calls decision2S_boundary normal endpoint (fixes pos2S & oc2S well). Avoid use deprecated bayesplot function arguments whenever divergencies occured. (corrected) Added MAP variances vignette","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-3---february-2nd-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-3 - February 2nd, 2018","title":"RBesT 1.3-3 - February 2nd, 2018","text":"CRAN release: 2018-02-02 Change numerical equality testing use expect_equal (uses .equal internally accounting machine specifc tolerances) pass tests long double case. Numerical tolerances reverted back 1.3-1 settings.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-2---january-25th-2018","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-2 - January 25th, 2018","title":"RBesT 1.3-2 - January 25th, 2018","text":"CRAN release: 2018-01-25 Adjust numerical tolerances pass tests long double case","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-1---december-21st-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-1 - December 21st, 2017","title":"RBesT 1.3-1 - December 21st, 2017","text":"CRAN release: 2017-12-21 Add Trustees Columbia copyright respective files DESCRIPTION","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-13-0---december-21st-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.3-0 - December 21st, 2017","title":"RBesT 1.3-0 - December 21st, 2017","text":"Added probability success calculation 1+2 sample case. Added decision1+2S_boundary functions (deprecated use y2 argument oc functions) Added RBesT.integrate_args option greater control density integrations. Correct cumulative predictive beta mixtures return 0/1 --range values (instead leaving ). Deprecated functions oc1+2Sdecision replaced decision1+2S.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-12-3---august-21st-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.2-3 - August 21st, 2017","title":"RBesT 1.2-3 - August 21st, 2017","text":"CRAN release: 2017-08-21 Fix plotting procedures work bayesplot 1.3.0","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-12-2---july-12th-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.2-2 - July 12th, 2017","title":"RBesT 1.2-2 - July 12th, 2017","text":"CRAN release: 2017-07-12 speedup example runtimes.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-12-1---july-12th-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.2-1 - July 12th, 2017","title":"RBesT 1.2-1 - July 12th, 2017","text":"Compactify reference PDF manual. Introduce sampling arguments gMAP. Shorten runtime examples.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-12-0---july-3rd-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.2-0 - July 3rd, 2017","title":"RBesT 1.2-0 - July 3rd, 2017","text":"First CRAN release. Update documentation.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-11-0---may-15th-2017","dir":"Changelog","previous_headings":"","what":"RBesT 1.1-0 - May 15th, 2017","title":"RBesT 1.1-0 - May 15th, 2017","text":"Redesign reference scale handling normal case. Enable standard error sufficient statistic  function. Introduced plotting options. Increased adapt_delta default set stepsize+max_treedepth default. Added RBesT.MC.{ncp, init, rescale} option. Corrections Poisson OC. pmixdiff function now integrates full support. Added  argument  enables designs based log-odds decisions relative risks. New graphical vignette new forest plot function. Use  standard plotting package.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-10-0---march-10th-2016","dir":"Changelog","previous_headings":"","what":"RBesT 1.0-0 - March 10th, 2016","title":"RBesT 1.0-0 - March 10th, 2016","text":"Stabilize integration pmixdiff beta mixtures logit transform. Set default adapt_delta 0.975. Made RBesT compatible ggplot2 2.0. Allowed n2=0  function.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-09-2---oct-28th-2015","dir":"Changelog","previous_headings":"","what":"RBesT 0.9-2 - Oct 28th 2015","title":"RBesT 0.9-2 - Oct 28th 2015","text":"Corrected Poisson stratified estimates. Added warning divergent transitions. Added crohn dataset.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-09-1---sept-3rd-2015","dir":"Changelog","previous_headings":"","what":"RBesT 0.9-1 - Sept 3rd 2015","title":"RBesT 0.9-1 - Sept 3rd 2015","text":"Minor typo fixes.","code":""},{"path":"http://opensource.nibr.com/RBesT/news/index.html","id":"rbest-09-0---sept-1st-2015","dir":"Changelog","previous_headings":"","what":"RBesT 0.9-0 - Sept 1st 2015","title":"RBesT 0.9-0 - Sept 1st 2015","text":"First release.","code":""}]

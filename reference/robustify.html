<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Add a non-informative component to a mixture prior."><title>Robustify Mixture Priors — robustify • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Robustify Mixture Priors — robustify"><meta property="og:description" content="Add a non-informative component to a mixture prior."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a>
    <a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a>
    <a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a>
    <a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a>
    <a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a>
    <a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Robustify Mixture Priors</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/HEAD/R/robustify.R" class="external-link"><code>R/robustify.R</code></a></small>
      <div class="d-none name"><code>robustify.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add a non-informative component to a mixture prior.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">robustify</span><span class="op">(</span><span class="va">priormix</span>, <span class="va">weight</span>, <span class="va">mean</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betaMix</span></span>
<span><span class="fu">robustify</span><span class="op">(</span><span class="va">priormix</span>, <span class="va">weight</span>, <span class="va">mean</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gammaMix</span></span>
<span><span class="fu">robustify</span><span class="op">(</span><span class="va">priormix</span>, <span class="va">weight</span>, <span class="va">mean</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for normMix</span></span>
<span><span class="fu">robustify</span><span class="op">(</span><span class="va">priormix</span>, <span class="va">weight</span>, <span class="va">mean</span>, n <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span>, <span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>priormix</dt>
<dd><p>orior (mixture of conjugate distributions).</p></dd>


<dt>weight</dt>
<dd><p>weight given to the non-informative component (0 &lt; <code>weight</code> &lt; 1).</p></dd>


<dt>mean</dt>
<dd><p>mean of the non-informative component. It is recommended to set this parameter explicitly.</p></dd>


<dt>n</dt>
<dd><p>number of observations the non-informative prior
corresponds to, defaults to 1.</p></dd>


<dt>...</dt>
<dd><p>optional arguments are ignored.</p></dd>


<dt>sigma</dt>
<dd><p>Sampling standard deviation for the case of Normal
mixtures.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>New mixture with an extra non-informative component named
<code>robust</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is recommended to robustify informative priors derived
with <code><a href="gMAP.html">gMAP</a></code> using unit-information priors . This
protects against prior-data conflict, see for example
<em>Schmidli et al., 2015</em>.</p>
<p>The procedure can be used with beta, gamma and normal mixture
priors. A unit-information prior (see <em>Kass and Wasserman,
1995</em>) corresponds to a prior which represents the observation of
n=1 at the null hypothesis. As the null is problem dependent we
<em>strongly recommend</em> to make use of the <code>mean</code> argument
accordingly. See below for the definition of the default mean.</p>
<p>The weights of the mixture priors are rescaled to <code>(1-weight)</code>
while the non-informative prior is assigned the <code>weight</code>
given.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>
    
<ul><li><p><code>robustify(betaMix)</code>: The default <code>mean</code> is set to 1/2 which
represents no difference between the occurrence rates for one of the
two outcomes. As the uniform <code>Beta(1,1)</code> is more appropriate in
practical applications, <code>RBesT</code> uses <code>n+1</code> as the sample
size such that the default robust prior is the uniform instead of
the <code>Beta(1/2,1/2)</code> which strictly defined would be the unit
information prior in this case.</p></li>
<li><p><code>robustify(gammaMix)</code>: The default <code>mean</code> is set to the mean of the
prior mixture. It is strongly recommended to explicitly set the
mean to the location of the null hypothesis.</p></li>
<li><p><code>robustify(normMix)</code>: The default <code>mean</code> is set to the mean
of the prior mixture. It is strongly recommended to explicitly set
the mean to the location of the null hypothesis, which is very
often equal to 0. It is also recommended to explicitly set the
sampling standard deviation using the <code>sigma</code> argument.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Schmidli H, Gsteiger S, Roychoudhury S, O'Hagan A,
Spiegelhalter D, Neuenschwander B.  Robust meta-analytic-predictive
priors in clinical trials with historical control information.
<em>Biometrics</em> 2014;70(4):1023-1032.</p>
<p>Kass RE, Wasserman L A Reference Bayesian Test for Nested
Hypotheses and its Relationship to the Schwarz Criterion <em>J
Amer Statist Assoc</em> 1995; 90(431):928-934.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mixcombine.html">mixcombine</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">bmix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixbeta.html">mixbeta</a></span><span class="op">(</span>inf1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>, inf2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">rbmix</span> <span class="op">&lt;-</span> <span class="fu">robustify</span><span class="op">(</span><span class="va">bmix</span>, weight<span class="op">=</span><span class="fl">0.1</span>, mean<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rbmix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate beta mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   inf1  inf2  robust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w  0.18  0.72  0.10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  8.00 10.00  1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  3.00  2.00  1.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rbmix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gmnMix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixgamma.html">mixgamma</a></span><span class="op">(</span>inf1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, inf2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, param<span class="op">=</span><span class="st">"mn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gmnMix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">rgmnMix</span> <span class="op">&lt;-</span> <span class="fu">robustify</span><span class="op">(</span><span class="va">gmnMix</span>, weight<span class="op">=</span><span class="fl">0.1</span>, mean<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rgmnMix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate Gamma mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   inf1  inf2  robust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w  0.18  0.72  0.10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  6.00 10.00  2.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  3.00  5.00  1.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rgmnMix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span>inf1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>, inf2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">rnMix</span> <span class="op">&lt;-</span> <span class="fu">robustify</span><span class="op">(</span><span class="va">nm</span>, weight<span class="op">=</span><span class="fl">0.1</span>, mean<span class="op">=</span><span class="fl">0</span>, sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rnMix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate normal mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference scale: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   inf1 inf2 robust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w 0.18 0.72 0.10  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m 0.50 2.00 0.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s 0.70 1.00 2.00  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rnMix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="robustify-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

